<!DOCTYPE html>
<html lang="en-GB">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>How to get the current selected Xcode and list installed</title>
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="How to get the current selected Xcode and list installed"/>
<meta name="twitter:description" content="Some tips &amp; tricks on how to get the current selected Xcode and check for available local versions."/>

    
    

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-uWxY/CJNBR+1zjPWmfnSnVxwRheevXITnMqoEIeG1LJrdI0GlVs/9cVSyPYXdcSF" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/style.css">

    
  </head>
  <body>
    <header>
  <div id="header-container">
    <div>
      <span>
        <a href="http://dive.github.io/">Home</a>
        <a href="http://dive.github.io/index.xml">RSS</a>
        
      </span>
    </div>
    <div>
      <span>
        <a href="https://github.com/dive">GitHub</a>
        <a href="https://twitter.com/justsitandgrin">Twitter</a>
        <a href="https://www.linkedin.com/in/artemloenko">LinkedIn</a>
      </span>
    </div>
  </div>
  
</header>

    
	<main>
		<article>
			<h1 class="title">How to get the current selected Xcode and list installed</h1>
			<time>16.05.2021 21:26</time>
			<div>
				<p>Some tips &amp; tricks on how to get the current selected Xcode and check for available local versions.</p>
<h2 id="current-selected-xcode">Current Selected Xcode</h2>
<h3 id="xcode-select"><code>xcode-select</code></h3>
<p>This is the most common way to get the path to the selected instance:</p>
<div class="highlight"><pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">xcrun xcode-select --print-path
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#93a1a1;font-style:italic"># Output</span>
% xcrun xcode-select --print-path
/Volumes/Extended/Archives/Xcode_12.5.app/Contents/Developer
</code></pre></div><p>According to the documentation:</p>
<blockquote>
<p>Prints the path to the currently selected developer directory.
This is useful for inspection, but scripts and other tools should use xcrun(1) to locate tool inside the active developer directory.</p>
</blockquote>
<p><em>Note</em>: If you wonder why I prefix the <code>xcode-select</code> with <code>xcrun</code> command, please, check the <a href="https://gist.github.com/dive/d2df088567b25971a44f02b1f05d6916">Multiple Xcode versions or Why <code>xcrun</code> is your friend</a> article.</p>
<h3 id="readlink"><code>readlink</code></h3>
<p>There is a trick to get the current selected Xcode version without the <code>xcode-select</code> tool. It can be helpful in some cases, but I recommend using <code>xcode-select</code> if you have no additional requirements. To check the current selected Xcode version without <code>xcode-select</code>, evaluate the following command:</p>
<div class="highlight"><pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">readlink /private/var/db/xcode_select_link
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#93a1a1;font-style:italic"># Output</span>
% readlink /private/var/db/xcode_select_link
/Volumes/Extended/Archives/Xcode_12.5.app/Contents/Developer
</code></pre></div><p>Every time you switch the default Xcode, <code>xcode-select</code> changes the link to the selected version. Perhaps, this is the fastest way to obtain the path, but it is not documented, and Apple can break it with any following Xcode release.</p>
<h2 id="list-of-installed-xcode-versions">List of installed Xcode versions</h2>
<h3 id="spotlight">Spotlight</h3>
<p>The easiest way to get the list of installed Xcode versions is to ask the Spotlight with the following command:</p>
<div class="highlight"><pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mdfind <span style="color:#2aa198">&#34;kMDItemCFBundleIdentifier = &#39;com.apple.dt.Xcode&#39;&#34;</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#93a1a1;font-style:italic"># Output</span>
% mdfind <span style="color:#2aa198">&#34;kMDItemCFBundleIdentifier = &#39;com.apple.dt.Xcode&#39;&#34;</span>
/Volumes/Extended/Archives/Xcode_12.5.app
/Volumes/Extended/Archives/Xcode_12.4.app
/Volumes/Extended/Archives/Xcode_12.1.app
/Volumes/Extended/Archives/Xcode_12.3.app
/Volumes/Extended/Archives/Xcode_12.2.app
</code></pre></div><p><em>Note</em>: This approach is usually not suitable for CI/Remote Builds because this is a popular option to disable Spotlight to improve performance.</p>
<h3 id="system_profile"><code>system_profile</code></h3>
<p>The less obvious way to get the list of installed Xcode versions is to use the <code>system_profiler</code>. It registers all the versions immediately when you extract them from the <code>xip</code> file.</p>
<div class="highlight"><pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">system_profiler -json SPDeveloperToolsDataType
</code></pre></div><p>The problem here is the output. It is vast and looks like the following for each installed version:</p>
<div class="highlight"><pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#268bd2;font-weight:bold">&#34;SPDeveloperToolsDataType&#34;</span> : [
    {
      <span style="color:#268bd2;font-weight:bold">&#34;_name&#34;</span> : <span style="color:#2aa198">&#34;spdevtools_info&#34;</span>,
      <span style="color:#268bd2;font-weight:bold">&#34;spdevtools_apps&#34;</span> : {
        <span style="color:#268bd2;font-weight:bold">&#34;spinstruments_app&#34;</span> : <span style="color:#2aa198">&#34;12.5 (64544.130)&#34;</span>,
        <span style="color:#268bd2;font-weight:bold">&#34;spxcode_app&#34;</span> : <span style="color:#2aa198">&#34;12.5 (18205)&#34;</span>
      },
      <span style="color:#268bd2;font-weight:bold">&#34;spdevtools_path&#34;</span> : <span style="color:#2aa198">&#34;/Volumes/Extended/Archives/Xcode_12.5.app&#34;</span>,
      <span style="color:#268bd2;font-weight:bold">&#34;spdevtools_sdks&#34;</span> : {
        <span style="color:#268bd2;font-weight:bold">&#34;iOS&#34;</span> : {
          <span style="color:#268bd2;font-weight:bold">&#34;14.5&#34;</span> : <span style="color:#2aa198">&#34;(18E182)&#34;</span>
        },
        <span style="color:#268bd2;font-weight:bold">&#34;iOS Simulator&#34;</span> : {
          <span style="color:#268bd2;font-weight:bold">&#34;14.5&#34;</span> : <span style="color:#2aa198">&#34;(18E182)&#34;</span>
        },
        <span style="color:#268bd2;font-weight:bold">&#34;macOS&#34;</span> : {
          <span style="color:#268bd2;font-weight:bold">&#34;11.3&#34;</span> : <span style="color:#2aa198">&#34;(20E214)&#34;</span>,
          <span style="color:#268bd2;font-weight:bold">&#34;20.4&#34;</span> : <span style="color:#2aa198">&#34;&#34;</span>
        },
        <span style="color:#268bd2;font-weight:bold">&#34;tvOS&#34;</span> : {
          <span style="color:#268bd2;font-weight:bold">&#34;14.5&#34;</span> : <span style="color:#2aa198">&#34;(18L191)&#34;</span>
        },
        <span style="color:#268bd2;font-weight:bold">&#34;tvOS Simulator&#34;</span> : {
          <span style="color:#268bd2;font-weight:bold">&#34;14.5&#34;</span> : <span style="color:#2aa198">&#34;(18L191)&#34;</span>
        },
        <span style="color:#268bd2;font-weight:bold">&#34;watchOS&#34;</span> : {
          <span style="color:#268bd2;font-weight:bold">&#34;7.4&#34;</span> : <span style="color:#2aa198">&#34;(18T187)&#34;</span>
        },
        <span style="color:#268bd2;font-weight:bold">&#34;watchOS Simulator&#34;</span> : {
          <span style="color:#268bd2;font-weight:bold">&#34;7.4&#34;</span> : <span style="color:#2aa198">&#34;(18T187)&#34;</span>
        }
      },
      <span style="color:#268bd2;font-weight:bold">&#34;spdevtools_version&#34;</span> : <span style="color:#2aa198">&#34;12.5 (12E262)&#34;</span>
    },
...
}
</code></pre></div><h4 id="parse-the-system_profiler-output-with-jq">Parse the <code>system_profiler</code> output with <code>jq</code></h4>
<p>You have to parse the <code>system_profiler</code> output to provide meaningful information. One option is to use <a href="https://github.com/stedolan/jq">jq</a> – a lightweight and flexible command-line JSON processor. For example, if you want to list paths:</p>
<div class="highlight"><pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">system_profiler -json SPDeveloperToolsDataType | jq <span style="color:#2aa198">&#39;.SPDeveloperToolsDataType[].spdevtools_path&#39;</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#93a1a1;font-style:italic"># Output</span>
% system_profiler -json SPDeveloperToolsDataType | jq <span style="color:#2aa198">&#39;.SPDeveloperToolsDataType[].spdevtools_path&#39;</span>
<span style="color:#2aa198">&#34;/Volumes/Extended/Archives/Xcode_12.5.app&#34;</span>
<span style="color:#2aa198">&#34;/Volumes/Extended/Archives/Xcode_12.4.app&#34;</span>
<span style="color:#2aa198">&#34;/Volumes/Extended/Archives/Xcode_12.3.app&#34;</span>
<span style="color:#2aa198">&#34;/Volumes/Extended/Archives/Xcode_12.2.app&#34;</span>
<span style="color:#2aa198">&#34;/Volumes/Extended/Archives/Xcode_12.1.app&#34;</span>
</code></pre></div><p>Or for installed versions:</p>
<div class="highlight"><pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">system_profiler -json SPDeveloperToolsDataType | jq <span style="color:#2aa198">&#39;.SPDeveloperToolsDataType[].spdevtools_apps.spxcode_app&#39;</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#93a1a1;font-style:italic"># Output</span>
% system_profiler -json SPDeveloperToolsDataType | jq <span style="color:#2aa198">&#39;.SPDeveloperToolsDataType[].spdevtools_apps.spxcode_app&#39;</span>
<span style="color:#2aa198">&#34;12.5 (18205)&#34;</span>
<span style="color:#2aa198">&#34;12.4 (17801)&#34;</span>
<span style="color:#2aa198">&#34;12.3 (17715)&#34;</span>
<span style="color:#2aa198">&#34;12.2 (17535)&#34;</span>
<span style="color:#2aa198">&#34;12.1 (17222)&#34;</span>
</code></pre></div><h2 id="tips--tricks">Tips &amp; Tricks</h2>
<h3 id="how-to-get-the-installed-xcode-version">How to get the installed Xcode version</h3>
<p>When you have the path to the current selected Xcode, then you can use the following function to extract <code>CFBundleShortVersionString</code> or <code>ProductBuildVersion</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#93a1a1;font-style:italic">#!/bin/sh -e
</span><span style="color:#93a1a1;font-style:italic"></span>
<span style="color:#859900">function</span> xcodeBundleVersion() {
    defaults <span style="color:#cb4b16">read</span> <span style="color:#2aa198">&#34;</span><span style="color:#2aa198">${</span><span style="color:#268bd2">1</span><span style="color:#2aa198">}</span><span style="color:#2aa198">/../version.plist&#34;</span> <span style="color:#2aa198">&#34;CFBundleShortVersionString&#34;</span>
}

<span style="color:#859900">function</span> xcodeBuildVersion() {
    defaults <span style="color:#cb4b16">read</span> <span style="color:#2aa198">&#34;</span><span style="color:#2aa198">${</span><span style="color:#268bd2">1</span><span style="color:#2aa198">}</span><span style="color:#2aa198">/../version.plist&#34;</span> <span style="color:#2aa198">&#34;ProductBuildVersion&#34;</span>
}

<span style="color:#859900">function</span> xcodeVersion() {
    <span style="color:#268bd2">BUNDLE_VERSION</span>=<span style="color:#859900">$(</span>xcodeBundleVersion <span style="color:#2aa198">${</span><span style="color:#268bd2">1</span><span style="color:#2aa198">}</span><span style="color:#859900">)</span>
    <span style="color:#268bd2">BUILD_VERSION</span>=<span style="color:#859900">$(</span>xcodeBuildVersion <span style="color:#2aa198">${</span><span style="color:#268bd2">1</span><span style="color:#2aa198">}</span><span style="color:#859900">)</span>
    <span style="color:#cb4b16">echo</span> <span style="color:#2aa198">&#34;Xcode </span><span style="color:#2aa198">${</span><span style="color:#268bd2">BUNDLE_VERSION</span><span style="color:#2aa198">}</span><span style="color:#2aa198"> (</span><span style="color:#2aa198">${</span><span style="color:#268bd2">BUILD_VERSION</span><span style="color:#2aa198">}</span><span style="color:#2aa198">)&#34;</span>
}

<span style="color:#93a1a1;font-style:italic"># Note that you can replace the `xcode-select` call with other methods to extract the path</span>
<span style="color:#268bd2">XCODE_VERSION</span>=<span style="color:#859900">$(</span>xcodeVersion <span style="color:#859900">$(</span>xcrun xcode-select --print-path<span style="color:#859900">))</span>
<span style="color:#cb4b16">echo</span> <span style="color:#268bd2">$XCODE_VERSION</span>
</code></pre></div><h3 id="faster-xcode-secure-archive-expansion-xip">Faster Xcode secure-archive expansion (<code>xip</code>)</h3>
<p>When you download a <code>xip</code> secure archive, you can expand it from CLI with <code>xip</code> tool. In this case, the validation of the archive will not be attempted. On Mac mini M1, it takes around four minutes to expand it.</p>
<div class="highlight"><pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">% du -h Xcode_12.0.1.xip
  10G    Xcode_12.0.1.xip

% <span style="color:#cb4b16">time</span> xip --expand Xcode_12.0.1.xip
xip: signing certificate was <span style="color:#2aa198">&#34;Development Update&#34;</span> (validation not attempted)
xip: expanded items from <span style="color:#2aa198">&#34;/Users/dive/Downloads/Xcode_12.0.1.xip&#34;</span>
xip --expand Xcode_12.0.1.xip  901.47s user 139.39s system 420% cpu 4:07.79 total
</code></pre></div><h3 id="xcodes--a-command-line-tool-to-install-and-switch-between-multiple-versions-of-xcode"><code>xcodes</code> – a command-line tool to install and switch between multiple versions of Xcode</h3>
<p>I can recommend <a href="https://github.com/RobotsAndPencils/xcodes">xcodes</a> as a tool to manage your Xcode installation. The tool itself has a few benefits:</p>
<ul>
<li>When <a href="https://aria2.github.io/">aria2</a> (a lightweight multi-protocol &amp; multi-source command-line download utility) installed, then <code>xcodes</code> will default to use it for downloads. It uses up to 16 connections to download Xcode 3-5x faster than usual</li>
<li><code>xcodes</code> written in Swift. Improve, fix and evolve if you need something from the tool</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">% xcodes installed 
12.1 (12A7403)           /Volumes/Extended/Archives/Xcode_12.1.app
12.2 (12B45b)            /Volumes/Extended/Archives/Xcode_12.2.app
12.3 (12C33)             /Volumes/Extended/Archives/Xcode_12.3.app
12.4 (12D4e)             /Volumes/Extended/Archives/Xcode_12.4.app
12.5 (12E262) (Selected) /Volumes/Extended/Archives/Xcode_12.5.app
</code></pre></div><p>It relies on <a href="https://xcodereleases.com/">xcodereleases.com</a> data (<a href="https://xcodereleases.com/data.json">JSON</a>), so you can expect delays between releases and the tool updates. But usually, it takes 10-20 minutes for an update.</p>
<p><em>Note</em>: The tool downloads Xcode versions directly from the Apple Developer Portal. And this is the only way to do so. Please, do not download Xcode versions from third-party storages.</p>
			</div>
			
			<a href="/tags/#xcode" class="tags">#Xcode</a>
			
			<div>
				
			</div>
		</article>
	</main>
<aside>
	<div>
		<div>
			<h3>LATEST POSTS</h3>
		</div>
		<div>
			<ul>
				
				<li><a href="/posts/get_current_selected.xcode/">How to get the current selected Xcode and list installed</a></li>
				
				<li><a href="/posts/multiple_xcode_versions_and_xcrun/">Multiple Xcode versions or Why `xcrun` is your friend</a></li>
				
				<li><a href="/posts/twitter_digest_september_2020/">Twitter Digest / October, 2020</a></li>
				
				<li><a href="/posts/grammarly_ios_unboxing/">Grammarly iOS Keyboard - Unboxing</a></li>
				
				<li><a href="/posts/xed_xcode_invocation_tool/">Xcode invocation tool - xed</a></li>
				
			</ul>
		</div>
	</div>
</aside>


    <footer>
  <p>&copy; 2021 <a href="http://dive.github.io/">Just sit and grin</a></p>
</footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-kQtW33rZJAHjgefvhyyzcGF3C5TFyBQBA13V1RKPf4uH+bwyzQxZ6CmMZHmNBEfJ" crossorigin="anonymous"></script>
  </body>
</html>
