<!DOCTYPE html><html dir="ltr" lang="en-GB" class="scroll-smooth" data-astro-cid-sckkx6r4> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://justsitandgrin.im/posts/swift_package_manager_builds_ios_frameworks/"><meta name="generator" content="Astro v5.16.6"><!-- General Meta Tags --><title>Swift Package Manager builds iOS frameworks (Updated. Xcode 10.2 Beta) | Artem Loenko</title><meta name="title" content="Swift Package Manager builds iOS frameworks (Updated. Xcode 10.2 Beta) | Artem Loenko"><meta name="description" content="Swift Package Manager doesn't work with iOS. Probably, that's all you can say about the current state of SPM, but insomnia forced me to extend the answer to the following essay."><meta name="author" content="Artem Loenko"><link rel="sitemap" href="/sitemap-index.xml"><!-- Open Graph / Facebook --><meta property="og:title" content="Swift Package Manager builds iOS frameworks (Updated. Xcode 10.2 Beta) | Artem Loenko"><meta property="og:description" content="Swift Package Manager doesn't work with iOS. Probably, that's all you can say about the current state of SPM, but insomnia forced me to extend the answer to the following essay."><meta property="og:url" content="https://justsitandgrin.im/posts/swift_package_manager_builds_ios_frameworks/"><meta property="og:image" content="https://justsitandgrin.im/posts/swift_package_manager_builds_ios_frameworks/index.png"><!-- Article Published/Modified time --><meta property="article:published_time" content="2020-01-04T22:53:00.000Z"><meta property="article:modified_time" content="2020-01-05T00:12:36.000Z"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://justsitandgrin.im/posts/swift_package_manager_builds_ios_frameworks/"><meta property="twitter:title" content="Swift Package Manager builds iOS frameworks (Updated. Xcode 10.2 Beta) | Artem Loenko"><meta property="twitter:description" content="Swift Package Manager doesn't work with iOS. Probably, that's all you can say about the current state of SPM, but insomnia forced me to extend the answer to the following essay."><meta property="twitter:image" content="https://justsitandgrin.im/posts/swift_package_manager_builds_ios_frameworks/index.png"><!-- Google JSON-LD Structured data --><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Swift Package Manager builds iOS frameworks (Updated. Xcode 10.2 Beta) | Artem Loenko","image":"https://justsitandgrin.im/posts/swift_package_manager_builds_ios_frameworks/index.png","datePublished":"2020-01-04T22:53:00.000Z","dateModified":"2020-01-05T00:12:36.000Z","author":[{"@type":"Person","name":"Artem Loenko","url":"https://github.com/dive"}]}</script><!-- Enable RSS feed auto-discovery  --><!-- https://docs.astro.build/en/recipes/rss/#enabling-rss-feed-auto-discovery --><link rel="alternate" type="application/rss+xml" title="Artem Loenko" href="https://justsitandgrin.im/rss.xml"><meta name="theme-color" content=""><script src="/toggle-theme.js"></script><link rel="stylesheet" href="/_astro/about.BEYnfoaa.css">
<style>@keyframes astroFadeInOut{0%{opacity:1}to{opacity:0}}@keyframes astroFadeIn{0%{opacity:0;mix-blend-mode:plus-lighter}to{opacity:1;mix-blend-mode:plus-lighter}}@keyframes astroFadeOut{0%{opacity:1;mix-blend-mode:plus-lighter}to{opacity:0;mix-blend-mode:plus-lighter}}@keyframes astroSlideFromRight{0%{transform:translate(100%)}}@keyframes astroSlideFromLeft{0%{transform:translate(-100%)}}@keyframes astroSlideToRight{to{transform:translate(100%)}}@keyframes astroSlideToLeft{to{transform:translate(-100%)}}@media (prefers-reduced-motion){::view-transition-group(*),::view-transition-old(*),::view-transition-new(*){animation:none!important}[data-astro-transition-scope]{animation:none!important}}
:where([data-astro-image]){object-fit:var(--fit);object-position:var(--pos);height:auto}:where([data-astro-image=full-width]){width:100%}:where([data-astro-image=constrained]){max-width:100%}
</style><style>[data-astro-transition-scope="astro-fam6wyqg-1"] { view-transition-name: swift-package-manager-builds-i-os-frameworks-updated-xcode-10-2-beta; }@layer astro { ::view-transition-old(swift-package-manager-builds-i-os-frameworks-updated-xcode-10-2-beta) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(swift-package-manager-builds-i-os-frameworks-updated-xcode-10-2-beta) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(swift-package-manager-builds-i-os-frameworks-updated-xcode-10-2-beta) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(swift-package-manager-builds-i-os-frameworks-updated-xcode-10-2-beta) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-fam6wyqg-1"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-fam6wyqg-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-fam6wyqg-1"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-fam6wyqg-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-fam6wyqg-1"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-fam6wyqg-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-fam6wyqg-1"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-fam6wyqg-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style><style>[data-astro-transition-scope="astro-36ssibgs-2"] { view-transition-name: i-os; }@layer astro { ::view-transition-old(i-os) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(i-os) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(i-os) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(i-os) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-2"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-2"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-2"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-2"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-2"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style><style>[data-astro-transition-scope="astro-36ssibgs-3"] { view-transition-name: spm; }@layer astro { ::view-transition-old(spm) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(spm) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(spm) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(spm) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-3"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-3"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-3"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-3"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-3"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style><style>[data-astro-transition-scope="astro-36ssibgs-4"] { view-transition-name: swift; }@layer astro { ::view-transition-old(swift) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(swift) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(swift) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(swift) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-4"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-4"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-4"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-4"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-36ssibgs-4"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-36ssibgs-4"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-36ssibgs-4"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-36ssibgs-4"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style></head> <body data-astro-cid-sckkx6r4>  <a id="skip-to-content" href="#main-content" class="absolute start-16 -top-full z-50 bg-background px-3 py-2 text-accent backdrop-blur-lg transition-all focus:top-4">
Skip to content
</a> <header class="app-layout flex flex-col items-center justify-between sm:flex-row"> <div id="top-nav-wrap" class="py-4 sm:py-6 border-b border-border relative w-full bg-background flex items-baseline justify-between sm:items-center"> <a href="/" class="absolute py-1 text-xl leading-8 font-semibold whitespace-nowrap sm:static sm:my-auto sm:text-2xl sm:leading-none"> Artem Loenko </a> <nav id="nav-menu" class="flex w-full flex-col items-center sm:ms-2 sm:flex-row sm:justify-end sm:space-x-4 sm:py-0"> <button id="menu-btn" class="focus-outline self-end p-2 sm:hidden" aria-label="Open Menu" aria-expanded="false" aria-controls="menu-items"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="hidden" id="close-icon"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M18 6l-12 12" /><path d="M6 6l12 12" /></svg> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-menu-deep" id="menu-icon"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M4 6h16" /><path d="M7 12h13" /><path d="M10 18h10" /></svg> </button> <ul id="menu-items" class="mt-4 grid w-44 grid-cols-2 place-content-center gap-2 [&#38;>li>a]:block [&#38;>li>a]:px-4 [&#38;>li>a]:py-3 [&#38;>li>a]:text-center [&#38;>li>a]:font-medium [&#38;>li>a]:hover:text-accent sm:[&#38;>li>a]:px-2 sm:[&#38;>li>a]:py-1 hidden sm:mt-0 sm:flex sm:w-auto sm:gap-x-5 sm:gap-y-0"> <li class="col-span-2"> <a href="/posts" class="active-nav">
Posts
</a> </li> <li class="col-span-2"> <a href="/tags">
Tags
</a> </li> <li class="col-span-2"> <a href="/about">
About
</a> </li> <li class="col-span-2"> <a href="/archives" title="Archives" aria-label="archives" class="group inline-flex items-center gap-1 hover:text-accent focus-outline flex justify-center p-3 sm:p-1">  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="hidden sm:inline-block"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M3 4m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v0a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z" /><path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" /><path d="M10 12l4 0" /></svg> <span class="sm:sr-only">Archives</span>  </a> </li> <li class="col-span-1 flex items-center justify-center"> <a href="/search" title="Search" aria-label="search" class="group inline-flex items-center gap-1 hover:text-accent focus-outline flex p-3 sm:p-1">  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-search"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg> <span class="sr-only">Search</span>  </a> </li> <li class="col-span-1 flex items-center justify-center"> <button id="theme-btn" class="focus-outline relative size-12 p-4 sm:size-8 hover:[&>svg]:stroke-accent" title="Toggles light & dark" aria-label="auto" aria-live="polite"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="absolute top-[50%] left-[50%] -translate-[50%] scale-100 rotate-0 transition-all dark:scale-0 dark:-rotate-90"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" /></svg> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="absolute top-[50%] left-[50%] -translate-[50%] scale-0 rotate-90 transition-all dark:scale-100 dark:rotate-0"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M14.828 14.828a4 4 0 1 0 -5.656 -5.656a4 4 0 0 0 5.656 5.656z" /><path d="M6.343 17.657l-1.414 1.414" /><path d="M6.343 6.343l-1.414 -1.414" /><path d="M17.657 6.343l1.414 -1.414" /><path d="M17.657 17.657l1.414 1.414" /><path d="M4 12h-2" /><path d="M12 4v-2" /><path d="M20 12h2" /><path d="M12 20v2" /></svg> </button> </li> </ul> </nav> </div> </header> <script type="module">function s(){const e=document.querySelector("#menu-btn"),t=document.querySelector("#menu-items"),n=document.querySelector("#menu-icon"),o=document.querySelector("#close-icon");!e||!t||!n||!o||e.addEventListener("click",()=>{const c=e.getAttribute("aria-expanded")==="true";e.setAttribute("aria-expanded",c?"false":"true"),e.setAttribute("aria-label",c?"Open Menu":"Close Menu"),t.classList.toggle("hidden"),n.classList.toggle("hidden"),o.classList.toggle("hidden")})}s();document.addEventListener("astro:after-swap",s);</script> <div class="app-layout flex items-center justify-start"><a id="back-button" href="/" class="group inline-flex items-center gap-1 hover:text-accent focus-outline -ms-2 mt-8 mb-2 hover:text-foreground/75"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 rtl:rotate-180"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M15 6l-6 6l6 6" /></svg><span>Go back</span> </a></div><script type="module">function o(){const t=document.querySelector("#back-button"),e=sessionStorage.getItem("backUrl");e&&t&&(t.href=e)}document.addEventListener("astro:page-load",o);o();</script> <main id="main-content" class="app-layout pb-12" data-pagefind-body> <h1 class="inline-block text-2xl font-bold text-accent sm:text-3xl" data-astro-transition-scope="astro-fam6wyqg-1"> Swift Package Manager builds iOS frameworks (Updated. Xcode 10.2 Beta) </h1> <div class="my-2 flex items-center gap-2"> <div class="flex items-center gap-x-2 opacity-80"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 min-w-5.5"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M4 7a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12z" /><path d="M16 3v4" /><path d="M8 3v4" /><path d="M4 11h16" /><path d="M7 14h.013" /><path d="M10.01 14h.005" /><path d="M13.01 14h.005" /><path d="M16.015 14h.005" /><path d="M13.015 17h.005" /><path d="M7.01 17h.005" /><path d="M10.01 17h.005" /></svg> <span class="text-sm sm:text-base">
Updated:
</span> <time class="text-sm sm:text-base" datetime="2020-01-05T00:12:36.000Z">5 Jan, 2020</time> </div> <span aria-hidden="true" class="max-sm:hidden hidden">|</span>  </div> <article id="article" class="app-prose mt-8 w-full max-w-app prose-pre:bg-(--shiki-light-bg) dark:prose-pre:bg-(--shiki-dark-bg)"> <p>Swift Package Manager doesn’t work with iOS. Probably, that’s all you can say about the current state of SPM, but insomnia forced me to extend the answer to the following essay.</p>
<h2 id="tldr">TL;DR</h2>
<ul>
<li>Yes, you can build iOS frameworks with Swift Package Manager;</li>
<li>Yes, you can adjust settings via <code>.xcconfig</code> and reuse generated <code>.xcodeproj</code> in a real iOS application without 3rd party tools to parse a project structure, scripts on Ruby, etc.;</li>
<li>Yes, you can use <code>swift build</code> to build your package but only as a library (though, with some additional limitations);</li>
<li>No, you can not use <code>swift test</code> because you have to spawn a simulator to run them.</li>
</ul>
<h2 id="current-state-of-swift-package-manager">Current State of Swift Package Manager</h2>
<p>iOS support is a hot topic in <a href="https://swift.org/package-manager/">Swift Package Manager</a> community, and from time to time someone raises this question again, but the reaction can be summarised to the following comments (<a href="https://forums.swift.org/t/spm-roadmap/6870">full thread</a> on forums.swift.org):</p>
<p>@<a href="https://forums.swift.org/u/rballard">Rick Ballard</a></p>
<blockquote>
<p>I think that this will be <strong>best provided by native IDE integration</strong>. However, in the meantime, I’d welcome contributions to help improve Xcode’s project generation support.</p>
</blockquote>
<p>@<a href="https://forums.swift.org/u/akashivskyy">Adrian Kashivskyy</a></p>
<blockquote>
<p>The last thing I want from a platform-agnostic open-source package manager is built-in integration with a single-platform commercial closed-source IDE. :confused:
I think this should be done independently by DT team, without any special favouritism by SPM.</p>
</blockquote>
<p>And you know what? I agree with these statements. Especially after some researches. In general, SPM is a very ‘young’ and inflexible project. There are a lot of limitations, especially around <code>generate-xcodeproj</code> options of <code>swift package</code> tool, and it is understandable. Swift is a language, and all related tools should be platform-agnostic as much as possible. Yeah, iOS is the biggest Swift consumer, and Apple contributes to Swift mostly because of iOS. But. It’s almost impossible to grow Swift to a mature technology if you’re limited and restricted by Xcode / iOS specific things / etc. And, it seems, this is the primary goal for Swift. Just be a language. The fate of Objective C is a good example of why Apple and Swift’s community are trying to be agnostic. They are trying to build something big, and lack of iOS support is the price (among many others) at the moment. :kiss:</p>
<p>Anyway, we have exciting news about SPM and iOS friendship. <a href="https://forums.swift.org/t/accepted-with-modifications-se-0236-package-manager-platform-deployment-settings/18420">SE-0236: Package Manager Platform Deployment Settings</a> is accepted with some modifications. And the implementation of this proposal will help a lot to move forward in case of iOS. The base goal is clear and straightforward:</p>
<blockquote>
<p>Packages should be able to declare the minimum required platform deployment target version. SwiftPM currently uses a hardcoded value for the macOS deployment target. This creates friction for packages which want to use APIs that were introduced after the hardcoded deployment target version.</p>
</blockquote>
<p>Why will it not solve the problem with iOS support at all? Just read the <a href="https://github.com/apple/swift-evolution/blob/master/proposals/0236-package-manager-platform-deployment-settings.md">“This proposal doesn’t handle these problems”</a> section.</p>
<h3 id="xcode-102-beta">Xcode 10.2 Beta</h3>
<p><a href="https://github.com/apple/swift-evolution/blob/master/proposals/0236-package-manager-platform-deployment-settings.md">SE-0236</a> was accepted and implemented in Swift 5, and Apple shipped it with the latest Xcode 10.2 beta. It means that you can specify an iOS as a deployment target for your packages with a simple line in your <code>Package.swift</code> file:</p>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="swift"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic">// Specify target platforms</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">platforms</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA">:</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> [ .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478">iOS</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478">v12</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> ]</span></span></code></pre>
<p>You can find an example in <code>xcode_10_2_beta</code> branch in the example <a href="https://github.com/dive/spm-ios-example/tree/xcode%5F10%5F2%5Fbeta">repository</a>. It is still a beta implementation, and you will have a lot of issues with <code>build</code> command, <code>run</code> doesn’t work as well, but this is a step forward to support iOS finally.</p>
<p>I hope that Apple will announce something <strong>good</strong> on WWDC’19. New IDE for Swift? Open sourced <code>xcodebuild</code>? <code>xcodebuild</code> replacement based on <code>llbuild</code>? Will see. The current state is complicated as much as it can be. We are trying to inject open-sourced platform-agnostic tools into a legacy (?) world of Xcode, and this problem can be solved only in two ways: iOS specific build tools go open source, or Xcode team supports Swift infrastructure.</p>
<h2 id="is-it-possible-to-build-an-ios-framework-with-spm-yes-yes-it-is">Is it possible to build an iOS framework with SPM? Yes! Yes, it is!</h2>
<p>So. If you try to search for solutions to build iOS frameworks with SPM on DuckDuckGo, you will find some instructions (<a href="https://github.com/j-channings/swift-package-manager-ios">1</a>, <a href="https://www.ralfebert.de/ios/swift-package-manager-for-ios-projects/">2</a>). But all of them have this step that I hate: <code>sudo gem install xcodeproj</code> :disgusting:. Can we do better? Let’s try.</p>
<p>First of all, let’s generate a template:</p>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="bash"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic"># Initialise a package with a library type</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">swift</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> package</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> init</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> --type</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> library</span></span></code></pre>
<p>Now we have to convince SPM that we want an iOS project when it generates <code>xcodeproj</code>. How? With <code>xcconfig</code>, of course. Create a file <code>ios.xcconfig</code> and put it to <code>./Sources</code> folder. For example, let’s start with a basic version:</p>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="bash"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">SDKROOT</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> =</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> iphoneos</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">SUPPORTED_PLATFORMS</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> =</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> iphonesimulator</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> iphoneos</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">IPHONEOS_DEPLOYMENT_TARGET</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> =</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 12.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">ARCHS</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> $(</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">ARCHS_STANDARD</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">VALID_ARCHS</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> $(</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">ARCHS_STANDARD</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">VALIDATE_PRODUCT</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> =</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> YES</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">LD_RUNPATH_SEARCH_PATHS</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> $(</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">inherited</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">) </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">@executable_path/Frameworks</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">TARGETED_DEVICE_FAMILY</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> =</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> 1,</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 2</span></span></code></pre>
<p>Looks good. Let’s see what SPM thinks about it:</p>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="bash"><code><span class="line"><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic"># Generate .xcodeproj file for the package in the current folder</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">swift</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> package</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> generate-xcodeproj</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> --xcconfig-overrides</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> ./Sources/ios.xcconfig</span></span></code></pre>
<p>Did not know about <code>xcconfig-overrides</code>? Me either. It’s a hidden and undocumented feature (<a href="https://github.com/apple/swift-package-manager/commit/713a3e603e6682fe431074617343eb05852d10c5">commit</a>), thanks to <a href="https://github.com/ddunbar">@Daniel Dunbar</a>! Time to ask Xcode what it thinks about it.</p>
<p><img src="/images/xcode_spm_build_results.png" alt="Xcode SPM build results"></p>
<p><strong>Note</strong>: You do not have to specify a custom <code>.xcconfig</code> file if you are using Xcode 10.2 Beta with Swift 5 Toolchain. Check the <a href="https://github.com/dive/spm-ios-example/tree/xcode%5F10%5F2%5Fbeta">branch</a> for more details.</p>
<p>It works! Let’s celebrate! But nope. We’re not on Medium, so let’s try to dig deeper. Let’s check how the ‘Unit Tests’ target works, for example:</p>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="bash"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">spm-tutorial/Tests/spm-tutorialTests/XCTestManifests.swift:4:28:</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> error:</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> use</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> of</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> undeclared</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> type</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">XCTestCaseEntry</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">'</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">public</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> func</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> allTests</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">() -</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA">></span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> [XCTestCaseEntry] {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">                           ^~~~~~~~~~~~~~~</span></span></code></pre>
<p>It doesn’t. Due to this strange and suspicious <code>XCTestCaseEntry</code>. What is this? According to the <a href="https://github.com/apple/swift-corelibs-xctest/blob/237d97cadbc3c51d575c705bf8e4d8456a12827a/Sources/XCTest/Public/XCTestCase.swift#L24">swift-corelibs-xctest</a> source code:</p>
<blockquote>
<p>This is a compound type used by <code>XCTMain</code> to represent tests to run. It combines an <code>XCTestCase</code> subclass type with the list of test case methods to invoke on the class.</p>
</blockquote>
<p>And the <code>typealias</code> looks like this:</p>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="swift"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA">...</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA">public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA"> typealias</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D6DEEB"> XCTestCaseEntry</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA"> =</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (testCaseClass: XCTestCase.</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA">Type</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">, allTests: [(</span><span style="--shiki-light:#1976D2;--shiki-dark:#C5E478">String</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">, XCTestCaseClosure)])</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA">...</span></span></code></pre>
<p>Why it doesn’t work? The same:</p>
<blockquote>
<p>CoreLibs XCTest only supports desktop platforms</p>
</blockquote>
<p>Thanks to <a href="https://github.com/larryonoff">@larryonoff</a> and <a href="https://github.com/apple/swift-corelibs-xctest/pull/176">his work</a> on multi-platform support. But it’s still impossible to use it for our needs. You can join this <a href="https://github.com/apple/swift-corelibs-xctest/pull/61">Add Unit Testing Infrastructure</a> thread if you want to learn more about the current state of <code>swift-corelibs-xctest</code>. We will skip this topic and apply the fix to <code>XCTestManifests.swift</code>:</p>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="swift"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D6DEEB"> XCTest</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">#</span><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic">if</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> !</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA">os</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#7FDBCA">macOS</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD">)</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA"> &#x26;&#x26;</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> !</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA">os</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD">(</span><span style="--shiki-light:#1976D2;--shiki-dark:#7FDBCA">iOS</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD">)</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA">public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA"> func</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic"> allTests</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA"> -></span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> [XCTestCaseEntry] {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic">    return</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB"> [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478">        testCase</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF">spm_tutorialTests.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478">allTests</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">,</span></span>
<span class="line"><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">}</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">#</span><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic">endif</span></span></code></pre>
<p>See this <code>&#x26;&#x26; !os(iOS)</code>? It’s enough to continue our journey. Run Tests again and… We got what we need.</p>
<p><img src="/images/xcode_spm_test_results.png" alt="Xcode SPM test results"></p>
<p>Then I created a simple iOS <code>ExampleApp</code> and added the generated <code>xcodeproj</code> as a dependency. Of course, I’ve added some iOS specific code to the framework:</p>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="swift"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D6DEEB"> UIKit</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA">public</span><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic"> final</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D6DEEB"> FrameworkPackage</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA"> init</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD"> ()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> { }</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA">    public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA"> func</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic"> randomColor</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD">()</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA"> -></span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> UIColor {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic">        return</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> UIColor.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C5E478">random</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA">public</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA"> extension</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D6DEEB"> UIColor</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA">    public</span><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic"> static</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA"> var</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> random: UIColor {</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic">        return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478"> UIColor</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478">red</span><span style="--shiki-light:#212121;--shiki-dark:#82AAFF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF"> .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478">random</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478">in</span><span style="--shiki-light:#212121;--shiki-dark:#82AAFF">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 0</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA">...</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C">1</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478">green</span><span style="--shiki-light:#212121;--shiki-dark:#82AAFF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF"> .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478">random</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478">in</span><span style="--shiki-light:#212121;--shiki-dark:#82AAFF">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 0</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA">...</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C">1</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478">blue</span><span style="--shiki-light:#212121;--shiki-dark:#82AAFF">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF"> .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478">random</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478">in</span><span style="--shiki-light:#212121;--shiki-dark:#82AAFF">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 0</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA">...</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C">1</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">)</span><span style="--shiki-light:#6F42C1;--shiki-dark:#82AAFF">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478">alpha</span><span style="--shiki-light:#212121;--shiki-dark:#82AAFF">:</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 1</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">    }</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">}</span></span></code></pre>
<p>And then reuse it from the example app:</p>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="swift"><code><span class="line"><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D6DEEB"> UIKit</span></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic">import</span><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D6DEEB"> ios_framework_package</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D6DEEB">FrameworkPackage</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#D6DEEB"> ViewController</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478"> UIViewController </span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">{</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic">    override</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA"> func</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic"> viewDidLoad</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> {</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA">        super</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478">viewDidLoad</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA">        self</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#D6DEEB">view</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C5E478">backgroundColor</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478"> FrameworkPackage</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478">randomColor</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA">    @</span><span style="--shiki-light:#D32F2F;--shiki-light-font-style:inherit;--shiki-dark:#C792EA;--shiki-dark-font-style:italic">IBAction</span><span style="--shiki-light:#D32F2F;--shiki-dark:#C792EA"> func</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic"> pressed</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD">(</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_</span><span style="--shiki-light:#FF9800;--shiki-dark:#7FDBCA"> button</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">: UIButton</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D9F5DD">)</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> {</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#7FDBCA">        self</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">.</span><span style="--shiki-light:#1976D2;--shiki-dark:#D6DEEB">view</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">.</span><span style="--shiki-light:#24292EFF;--shiki-dark:#C5E478">backgroundColor</span><span style="--shiki-light:#D32F2F;--shiki-dark:#7FDBCA"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478"> FrameworkPackage</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">()</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#C5E478">randomColor</span><span style="--shiki-light:#212121;--shiki-dark:#D6DEEB">()</span></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">}</span></span></code></pre>
<p>The full example is available on <a href="https://github.com/dive/spm-ios-example">GitHub</a>.
Thanks to <code>CLANG_MODULES_AUTOLINK</code>, all iOS frameworks will be linked automatically. I didn’t try more complex scenarios (when one iOS module depends on another, etc.) because it’s not my goal at the moment. But in general, it just works with some limitations. SPM doesn’t set up our <code>xcconfig</code> for some targets, and you have to include the SPM-generated <code>.xcodeproj</code> to your <code>.xcodeproj</code>, but all these tradeoffs seem reasonable for this research and our current goal.</p>
<h2 id="back-to-swift-package-manager">Back to Swift Package Manager</h2>
<p>See. We can do better. But we forgot about SPM during this Xcode journey. Let’s close our fancy dark-themed Xcode, open Terminal and run <code>swift build</code> for our iOS’ish package (I’m going to use the package from the <a href="https://github.com/dive/spm-ios-example">example project</a> mentioned above):</p>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="bash"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">Compile</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> Swift</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> Module</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">ios_framework_package</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (1 </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">sources</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">./spm-ios-example/ios-framework-package/Sources/ios-framework-package/ios_framework_package.swift:1:8:</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> error:</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> no</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> such</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> module</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">UIKit</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">'</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">import</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> UIKit</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">       ^</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">error:</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> terminated</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">(</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">1</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">:</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/swift-build-tool</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> -f./spm-ios-example/ios-framework-package/.build/debug.yaml</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> main</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> output:</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> ...</span></span></code></pre>
<p>Okay. <code>no such module 'UIKit'</code>. Can we do better? Doubt it. But let’s try. First of all, we have to know where SPM gets all these environment variables, we can ask it with <code>swift build --verbose</code>:</p>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="bash"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">xcrun</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> --sdk</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> macosx</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> --show-sdk-path</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">xcrun</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> --sdk</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> macosx</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> --show-sdk-platform-path</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">xcrun</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> --find</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> clang</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">xcrun</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> --sdk</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> macosx</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> --find</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> xctest</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">sandbox-exec</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> -p</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">(version 1)</span></span></code></pre>
<p>Nice. No magic and jigsaws. Let’s try to change some <code>swiftc</code> options to build the project against proper <code>sdk</code> and <code>target</code>:</p>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="bash"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">swift</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> build</span><span style="--shiki-light:#24292EFF;--shiki-dark:#F78C6C"> \</span></span>
<span class="line"><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF">      -Xswiftc</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> "</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">-sdk</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">"</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> -Xswiftc</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> "</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">`</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">xcrun</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> --sdk</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> iphonesimulator</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> --show-sdk-path</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">`</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">"</span><span style="--shiki-light:#24292EFF;--shiki-dark:#F78C6C"> \</span></span>
<span class="line"><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF">      -Xswiftc</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> "</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">-target</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">"</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> -Xswiftc</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> "</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">x86_64-apple-ios12.1-simulator</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">"</span></span></code></pre>
<p>Looks better. We built the binary:</p>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="bash"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic">...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">Compile</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> Swift</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> Module</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">ios_framework_package</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (1 </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">sources</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span></code></pre>
<p>Let’s make some inspections, just to be sure that everything is fine:</p>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="bash"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">$</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> lipo</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> -archs</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> .build/x86_64-apple-macosx10.10/debug/ios_framework_package.build/ios_framework_package.swift.o</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">x86_64</span></span></code></pre>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="bash"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">$</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> nm</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> -extern-only</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> -defined-only</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> -just-symbol-name</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> .build/x86_64-apple-macosx10.10/debug/ios_framework_package.build/ios_framework_package.swift.o</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_$S12CoreGraphics7CGFloatVACSBAAWL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_$S12CoreGraphics7CGFloatVACSBAAWl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_$S12CoreGraphics7CGFloatVACSLAAWL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_$S12CoreGraphics7CGFloatVACSLAAWl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_$S21ios_framework_package16FrameworkPackageC11randomColorSo7UIColorCyF</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_$S21ios_framework_package16FrameworkPackageCACycfC</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_$S21ios_framework_package16FrameworkPackageCACycfc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_$S21ios_framework_package16FrameworkPackageCMa</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_$S21ios_framework_package16FrameworkPackageCMm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_$S21ios_framework_package16FrameworkPackageCMn</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_$S21ios_framework_package16FrameworkPackageCN</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_$S21ios_framework_package16FrameworkPackageCfD</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_$S21ios_framework_package16FrameworkPackageCfd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_$S21ios_framework_packageMXM</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_$SSo7UIColorC21ios_framework_packageE6randomABvgZ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_$SSo7UIColorC3red5green4blue5alphaAB12CoreGraphics7CGFloatV_A3ItcfC</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_$SSo7UIColorC3red5green4blue5alphaAB12CoreGraphics7CGFloatV_A3ItcfcTO</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_$SSo7UIColorCML</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_$SSo7UIColorCMa</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">___swift_reflection_version</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">__swift_FORCE_LOAD_$_swiftCoreFoundation_$_ios_framework_package</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">__swift_FORCE_LOAD_$_swiftCoreGraphics_$_ios_framework_package</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">__swift_FORCE_LOAD_$_swiftCoreImage_$_ios_framework_package</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">__swift_FORCE_LOAD_$_swiftDarwin_$_ios_framework_package</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">__swift_FORCE_LOAD_$_swiftDispatch_$_ios_framework_package</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">__swift_FORCE_LOAD_$_swiftFoundation_$_ios_framework_package</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">__swift_FORCE_LOAD_$_swiftMetal_$_ios_framework_package</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">__swift_FORCE_LOAD_$_swiftObjectiveC_$_ios_framework_package</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">__swift_FORCE_LOAD_$_swiftQuartzCore_$_ios_framework_package</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">__swift_FORCE_LOAD_$_swiftUIKit_$_ios_framework_package</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">_symbolic</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> ____</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> 21ios_framework_package16FrameworkPackageC</span></span></code></pre>
<p><code>lipo</code> is a bit useless in this case because we were building for a simulator, but <code>nm</code> shows everything we need to know - iOS frameworks symbols are available. Unfortunately, <code>swift build</code> doesn’t produce <code>.framework</code> by default. I think it’s doable even in this case but let’s postpone it ‘till next time’.</p>
<h2 id="epilogue-swift-test">Epilogue: swift test</h2>
<p>And the final call. We already have one unit-test for our package, it uses <code>UIKit</code>, and I would mark this experiment as successful if we can run the test target with <code>swift test</code>. It’s almost impossible, though, because usually, unit-tests for simulator have to spawn to a simulator process. I do not think that it’s even possible for <span class="underline">an actual</span> iOS project. Anyway.</p>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="bash"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">swift</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> test</span><span style="--shiki-light:#24292EFF;--shiki-dark:#F78C6C"> \</span></span>
<span class="line"><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF">      -Xswiftc</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> "</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">-sdk</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">"</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> -Xswiftc</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> "</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">`</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">xcrun</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> --sdk</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> iphonesimulator</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> --show-sdk-path</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">`</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">"</span><span style="--shiki-light:#24292EFF;--shiki-dark:#F78C6C"> \</span></span>
<span class="line"><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF">      -Xswiftc</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> "</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">-target</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">"</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> -Xswiftc</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> "</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">x86_64-apple-ios12.1-simulator</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">"</span></span></code></pre>
<p>And we face another problem. <code>.xctest</code> bundle is compiled but <code>xctest</code> tool is confused with search paths:</p>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="bash"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">Compile</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> Swift</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> Module</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">ios_framework_package</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (1 </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">sources</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">Compile</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> Swift</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> Module</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> '</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">ios_framework_packageTests</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">'</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (2 </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">sources</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">Linking</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> ./.build/x86_64-apple-macosx10.10/debug/ios-framework-packagePackageTests.xctest/Contents/MacOS/ios-framework-packagePackageTests</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">xctest[77129:8746476]</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> The</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> bundle</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> "</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">ios-framework-packagePackageTests.xctest</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">"</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> couldn</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">t be loaded because it is damaged or missing necessary resources. Try reinstalling the bundle.</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">xctest[77129:8746476](dlopen_preflight(.build/x86_64-apple-macosx10.10/debug/ios-framework-packagePackageTests.xctest/Contents/MacOS/ios-framework-packagePackageTests):</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">  **Library not loaded: /System/Library/Frameworks/UIKit.framework/UIKit**</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">  Referenced from: .build/x86_64-apple-macosx10.10/debug/ios-framework-packagePackageTests.xctest/Contents/MacOS/ios-framework-packagePackageTests</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">  Reason: image not found)</span></span></code></pre>
<p>Likely, <code>swift build &#x26; test</code> produce beneficial debug information and store it in <code>.build/debug.yaml</code> with all passed options and arguments. There are no differences with the options for a module itself, so it’s time for our command line friends again:</p>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="bash"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">$</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> otool</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> -L</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> .build/debug/ios-framework-packagePackageTests.xctest/Contents/MacOS/ios-framework-packagePackageTests</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">  /usr/lib/libobjc.A.dylib</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (compatibility </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">version</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> 1.0.0,</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> current</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> version</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 228.0.0</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">  /usr/lib/libSystem.B.dylib</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (compatibility </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">version</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> 1.0.0,</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> current</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> version</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 1252.200.5</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">======</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">  /System/Library/Frameworks/UIKit.framework/UIKit</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (compatibility </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">version</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> 1.0.0,</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> current</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> version</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 61000.0.0</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">======</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">  @rpath/XCTest.framework/Versions/A/XCTest</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (compatibility </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">version</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> 1.0.0,</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> current</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> version</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 14460.20.0</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">  @rpath/libswiftCore.dylib</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (compatibility </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">version</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> 1.0.0,</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> current</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> version</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 1000.11.42</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">  @rpath/libswiftCoreFoundation.dylib</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (compatibility </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">version</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> 1.0.0,</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> current</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> version</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 1000.11.42</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">  @rpath/libswiftCoreGraphics.dylib</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (compatibility </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">version</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> 1.0.0,</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> current</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> version</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 1000.11.42</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">  @rpath/libswiftCoreImage.dylib</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (compatibility </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">version</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> 1.0.0,</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> current</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> version</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 1000.11.42</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">  @rpath/libswiftDarwin.dylib</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (compatibility </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">version</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> 1.0.0,</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> current</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> version</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 1000.11.42</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">  @rpath/libswiftDispatch.dylib</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (compatibility </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">version</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> 1.0.0,</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> current</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> version</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 1000.11.42</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">  @rpath/libswiftFoundation.dylib</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (compatibility </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">version</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> 1.0.0,</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> current</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> version</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 1000.11.42</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">  @rpath/libswiftMetal.dylib</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (compatibility </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">version</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> 1.0.0,</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> current</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> version</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 1000.11.42</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">  @rpath/libswiftObjectiveC.dylib</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (compatibility </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">version</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> 1.0.0,</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> current</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> version</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 1000.11.42</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">  @rpath/libswiftQuartzCore.dylib</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (compatibility </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">version</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> 1.0.0,</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> current</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> version</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 1000.11.42</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">======</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">  @rpath/libswiftUIKit.dylib</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (compatibility </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">version</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> 1.0.0,</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> current</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> version</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 1000.11.42</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span>
<span class="line"><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">======</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">  @rpath/libswiftXCTest.dylib</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB"> (compatibility </span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D">version</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> 1.0.0,</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> current</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> version</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 1000.11.42</span><span style="--shiki-light:#24292EFF;--shiki-dark:#D6DEEB">)</span></span></code></pre>
<p>As you can see, for some reasons, it tries to link <code>UIKit.framework</code> twice:</p>
<ul>
<li>via <code>/System/Library/Frameworks</code> path</li>
<li>and via expected <code>@rpath/libswiftUIKit.dylib</code>.</li>
</ul>
<p>Let’s check the information from the module itself with <code>otool</code>, to be sure that <code>load</code> describes the correct framework to link:</p>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="bash"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">$</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> otool</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> -l</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> .build/debug/ios_framework_package.build/ios_framework_package.swift.o</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic">...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">Load</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> command</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 6</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">     cmd</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> LC_LINKER_OPTION</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic"> cmdsize</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 32</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">   count</span><span style="--shiki-light:#1976D2;--shiki-dark:#F78C6C"> 2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">  string</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic"> #1 -framework</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">  string</span><span style="--shiki-light:#C2C3C5;--shiki-light-font-style:inherit;--shiki-dark:#637777;--shiki-dark-font-style:italic"> #2 UIKit</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#C5E478;--shiki-dark-font-style:italic">...</span></span></code></pre>
<p>Seems correct to me. To remove the confusion, let’s pass the linking option directly with <code>-Xswiftc "-lswiftUIKit"</code>:</p>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="bash"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">swift</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> test</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> --verbose</span><span style="--shiki-light:#24292EFF;--shiki-dark:#F78C6C"> \</span></span>
<span class="line"><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF">      -Xswiftc</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> "</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">-sdk</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">"</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> -Xswiftc</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> "</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">`</span><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">xcrun</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> --sdk</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> iphonesimulator</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> --show-sdk-path</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">`</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">"</span><span style="--shiki-light:#24292EFF;--shiki-dark:#F78C6C"> \</span></span>
<span class="line"><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF">      -Xswiftc</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> "</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">-target</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">"</span><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF"> -Xswiftc</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> "</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">x86_64-apple-ios12.1-simulator</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">"</span><span style="--shiki-light:#24292EFF;--shiki-dark:#F78C6C"> \</span></span>
<span class="line"><span style="--shiki-light:#2B5581;--shiki-dark:#82AAFF">      -Xswiftc</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> "</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">-lswiftUIKit</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">"</span></span></code></pre>
<pre class="astro-code astro-code-themes min-light night-owl" style="--shiki-light:#24292eff;--shiki-dark:#d6deeb;--shiki-light-bg:#ffffff;--shiki-dark-bg:#011627; overflow-x: auto;--file-name-offset: -0.75rem;" tabindex="0" data-language="bash"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-style:inherit;--shiki-dark:#82AAFF;--shiki-dark-font-style:italic">xctest[18838:9855653]</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> The</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> bundle</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD"> "</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">ios-framework-packagePackageTests.xctest</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">"</span><span style="--shiki-light:#2B5581;--shiki-dark:#ECC48D"> couldn</span><span style="--shiki-light:#22863A;--shiki-dark:#D9F5DD">'</span><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">t be loaded because it is damaged or missing necessary resources. Try reinstalling the bundle.</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">xctest[18838:9855653]dlopen_preflight(./ios-example/ios-framework-package/.build/x86_64-apple-macosx10.10/debug/ios-framework-packagePackageTests.xctest/Contents/MacOS/ios-framework-packagePackageTests):</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">      **Library not loaded: @rpath/libswiftUIKit.dylib**</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">      ...</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">      Reason: no suitable image found.  Did find:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">      /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/swift/iphonesimulator/libswiftUIKit.dylib: mach-o,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#ECC48D">      **but built for simulator (not macOS)**</span></span></code></pre>
<p>This is the end, my only friend. We can link proper frameworks with minimum efforts, but it’s impossible to run these tests for iOS device or simulator without SPM support. It seems that even <code>xcrun</code> with <code>xctest</code> cannot handle it, we need <code>xcodebuild</code> assistance here. Enough these weird logs and useless speeches, let’s summarise.</p>
<h2 id="summary">Summary</h2>
<p>Thanks for reading, first of all! And what did we learn?</p>
<ul>
<li>We can use SPM in sporadic cases for iOS just for integration, thanks to <code>.xcconfig</code>;</li>
<li>Future of iOS and SPM friendship is foggy even with this <a href="https://forums.swift.org/t/accepted-with-modifications-se-0236-package-manager-platform-deployment-settings/18420">SE-0236</a> proposal;</li>
<li>Swift <code>build</code> and <code>test</code> helpers are useless for us without iOS-specific features and full Xcode support. And it’s unlikely to happen. Of course, SPM can be integrated on top of Xcode by Xcode team. For example, they will extend <code>xcodebuild</code> functionality. But it will be a different story which partly concerns SPM.</li>
</ul>
<p>About SPM. I think that it’s doable in general, and we can improve SPM to support any platform you want. My best guess at the moment is to introduce pipeline plugins for SPM. Where you can transfer the control flow to a separate tool with expected input and output. Something like Xcode custom build phases but smarter and more flexible. It will allow SPM to be platform-agnostic as now, but Xcode team can create a plugin for the whole iOS flow support. Or Uber. Or Google. Or me. Whatever.</p>
<p>Stay tuned and hydrated!</p> </article> <hr class="my-8 border-dashed">  <ul class="mt-4 mb-8 flex flex-wrap gap-4 sm:my-8"> <li> <a href="/tags/i-os/" class="flex items-center gap-0.5 border-b-2 border-dashed border-foreground hover:-mt-0.5 hover:border-accent hover:text-accent focus-visible:border-none focus-visible:text-accent text-sm" data-astro-transition-scope="astro-36ssibgs-2"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="opacity-80 size-4"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M5 9l14 0" /><path d="M5 15l14 0" /><path d="M11 4l-4 16" /><path d="M17 4l-4 16" /></svg> iOS </a> </li><li> <a href="/tags/spm/" class="flex items-center gap-0.5 border-b-2 border-dashed border-foreground hover:-mt-0.5 hover:border-accent hover:text-accent focus-visible:border-none focus-visible:text-accent text-sm" data-astro-transition-scope="astro-36ssibgs-3"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="opacity-80 size-4"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M5 9l14 0" /><path d="M5 15l14 0" /><path d="M11 4l-4 16" /><path d="M17 4l-4 16" /></svg> SPM </a> </li><li> <a href="/tags/swift/" class="flex items-center gap-0.5 border-b-2 border-dashed border-foreground hover:-mt-0.5 hover:border-accent hover:text-accent focus-visible:border-none focus-visible:text-accent text-sm" data-astro-transition-scope="astro-36ssibgs-4"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="opacity-80 size-4"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M5 9l14 0" /><path d="M5 15l14 0" /><path d="M11 4l-4 16" /><path d="M17 4l-4 16" /></svg> Swift </a> </li> </ul> <div id="btt-btn-container" class="fixed end-4 bottom-8 z-50 md:sticky md:end-auto md:float-end md:me-1 translate-y-14 opacity-0 transition duration-500"> <button data-button="back-to-top" class="group relative bg-background px-2 py-1 size-14 rounded-full shadow-xl md:h-8 md:w-fit md:rounded-md md:shadow-none md:focus-visible:rounded-none md:bg-background/35 md:bg-clip-padding md:backdrop-blur-lg"> <span id="progress-indicator" class="absolute inset-0 -z-10 block size-14 scale-110 rounded-full bg-transparent md:hidden md:h-8 md:rounded-md"></span> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block rotate-90 md:hidden"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M15 6l-6 6l6 6" /></svg> <span class="sr-only text-sm group-hover:text-accent md:not-sr-only"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-4"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M12 5l0 14" /><path d="M16 9l-4 -4" /><path d="M8 9l4 -4" /></svg>
Back To Top
</span> </button> </div> <script data-astro-rerun>
  /** Scrolls the document to the top when
   * the "Back to Top" button is clicked. */
  function backToTop() {
    const rootElement = document.documentElement;
    const btnContainer = document.querySelector("#btt-btn-container");
    const backToTopBtn = document.querySelector("[data-button='back-to-top']");
    const progressIndicator = document.querySelector("#progress-indicator");

    if (!rootElement || !btnContainer || !backToTopBtn || !progressIndicator)
      return;

    // Attach click event handler for back-to-top button
    backToTopBtn.addEventListener("click", () => {
      document.body.scrollTop = 0; // For Safari
      document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
    });

    // Handle button visibility according to scroll position
    let lastVisible = null;
    function handleScroll() {
      const scrollTotal = rootElement.scrollHeight - rootElement.clientHeight;
      const scrollTop = rootElement.scrollTop;
      const scrollPercent = Math.floor((scrollTop / scrollTotal) * 100);

      progressIndicator.style.setProperty(
        "background-image",
        `conic-gradient(var(--accent), var(--accent) ${scrollPercent}%, transparent ${scrollPercent}%)`
      );

      const isVisible = scrollTop / scrollTotal > 0.3;

      if (isVisible !== lastVisible) {
        btnContainer.classList.toggle("opacity-100", isVisible);
        btnContainer.classList.toggle("translate-y-0", isVisible);
        btnContainer.classList.toggle("opacity-0", !isVisible);
        btnContainer.classList.toggle("translate-y-14", !isVisible);
        lastVisible = isVisible;
      }
    }

    let ticking = false;
    document.addEventListener("scroll", () => {
      if (!ticking) {
        window.requestAnimationFrame(() => {
          handleScroll();
          ticking = false;
        });
        ticking = true;
      }
    });
  }
  backToTop();
</script> <div class="flex flex-none flex-col items-center justify-center gap-1 md:items-start"><span class="italic">Share this post on:</span><div class="text-center"><a href="https://wa.me/?text=https://justsitandgrin.im/posts/swift_package_manager_builds_ios_frameworks/" title="Share this post via WhatsApp" class="group inline-flex items-center gap-1 hover:text-accent scale-90 p-2 hover:rotate-6 sm:p-1"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M3 21l1.65 -3.8a9 9 0 1 1 3.4 2.9l-5.05 .9" /><path d="M9 10a.5 .5 0 0 0 1 0v-1a.5 .5 0 0 0 -1 0v1a5 5 0 0 0 5 5h1a.5 .5 0 0 0 0 -1h-1a.5 .5 0 0 0 0 1" /></svg><span class="sr-only">Share this post via WhatsApp</span> </a><a href="https://www.facebook.com/sharer.php?u=https://justsitandgrin.im/posts/swift_package_manager_builds_ios_frameworks/" title="Share this post on Facebook" class="group inline-flex items-center gap-1 hover:text-accent scale-90 p-2 hover:rotate-6 sm:p-1"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M7 10v4h3v7h4v-7h3l1 -4h-4v-2a1 1 0 0 1 1 -1h3v-4h-3a5 5 0 0 0 -5 5v2h-3" /></svg><span class="sr-only">Share this post on Facebook</span> </a><a href="https://x.com/intent/post?url=https://justsitandgrin.im/posts/swift_package_manager_builds_ios_frameworks/" title="Share this post on X" class="group inline-flex items-center gap-1 hover:text-accent scale-90 p-2 hover:rotate-6 sm:p-1"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M4 4l11.733 16h4.267l-11.733 -16z" /><path d="M4 20l6.768 -6.768m2.46 -2.46l6.772 -6.772" /></svg><span class="sr-only">Share this post on X</span> </a><a href="https://t.me/share/url?url=https://justsitandgrin.im/posts/swift_package_manager_builds_ios_frameworks/" title="Share this post via Telegram" class="group inline-flex items-center gap-1 hover:text-accent scale-90 p-2 hover:rotate-6 sm:p-1"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M15 10l-4 4l6 6l4 -16l-18 7l4 2l2 6l3 -4" /></svg><span class="sr-only">Share this post via Telegram</span> </a><a href="https://pinterest.com/pin/create/button/?url=https://justsitandgrin.im/posts/swift_package_manager_builds_ios_frameworks/" title="Share this post on Pinterest" class="group inline-flex items-center gap-1 hover:text-accent scale-90 p-2 hover:rotate-6 sm:p-1"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M8 20l4 -9" /><path d="M10.7 14c.437 1.263 1.43 2 2.55 2c2.071 0 3.75 -1.554 3.75 -4a5 5 0 1 0 -9.7 1.7" /><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /></svg><span class="sr-only">Share this post on Pinterest</span> </a><a href="mailto:?subject=See%20this%20post&#38;body=https://justsitandgrin.im/posts/swift_package_manager_builds_ios_frameworks/" title="Share this post via email" class="group inline-flex items-center gap-1 hover:text-accent scale-90 p-2 hover:rotate-6 sm:p-1"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M3 7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-10z" /><path d="M3 7l9 6l9 -6" /></svg><span class="sr-only">Share this post via email</span> </a></div></div> <hr class="my-6 border-dashed"> <!-- Previous/Next Post Buttons --> <div data-pagefind-ignore class="grid grid-cols-1 gap-6 sm:grid-cols-2"> <a href="/posts/emojis_over_time" class="flex w-full gap-1 hover:opacity-75"> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block flex-none rtl:rotate-180"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M15 6l-6 6l6 6" /></svg> <div> <span>Previous Post</span> <div class="text-sm text-accent/85">Emojis over time</div> </div> </a> <a href="/posts/xcode_macos_ios_betas" class="flex w-full justify-end gap-1 text-end hover:opacity-75 sm:col-start-2"> <div> <span>Next Post</span> <div class="text-sm text-accent/85">Note: Xcode 10.2, macOS Mojave 10.14.4, iOS 12.1 and other betas</div> </div> <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block flex-none rtl:rotate-180"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M9 6l6 6l-6 6" /></svg> </a> </div> </main> <footer class="app-layout mt-auto"> <div class="py-6 sm:py-4 border-t border-border flex flex-col items-center justify-between sm:flex-row-reverse"> <div class="flex flex-wrap items-center gap-1"> <a href="https://github.com/dive" title="GitHub - @dive" class="group inline-flex items-center gap-1 hover:text-accent p-2 hover:rotate-6 sm:p-1">  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" /></svg> <span class="sr-only">GitHub - @dive</span>  </a><a href="https://twitter.com/justsitandgrin" title="X - @justsitandgrin" class="group inline-flex items-center gap-1 hover:text-accent p-2 hover:rotate-6 sm:p-1">  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M4 4l11.733 16h4.267l-11.733 -16z" /><path d="M4 20l6.768 -6.768m2.46 -2.46l6.772 -6.772" /></svg> <span class="sr-only">X - @justsitandgrin</span>  </a><a href="https://www.linkedin.com/in/artemloenko/" title="LinkedIn - Artem Loenko" class="group inline-flex items-center gap-1 hover:text-accent p-2 hover:rotate-6 sm:p-1">  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block size-6 scale-125 fill-transparent stroke-current stroke-2 opacity-90 group-hover:fill-transparent sm:scale-110"><path stroke="none" d="M0 0h24v24H0z" fill="none" /><path d="M8 11v5" /><path d="M8 8v.01" /><path d="M12 16v-5" /><path d="M16 16v-3a2 2 0 1 0 -4 0" /><path d="M3 7a4 4 0 0 1 4 -4h10a4 4 0 0 1 4 4v10a4 4 0 0 1 -4 4h-10a4 4 0 0 1 -4 -4z" /></svg> <span class="sr-only">LinkedIn - Artem Loenko</span>  </a> </div> <div class="my-2 flex flex-col items-center whitespace-nowrap sm:flex-row"> <span>Copyright &#169; 2026</span> <span class="hidden sm:inline">&nbsp;|&nbsp;</span> <span>
Licensed under <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" class="underline hover:text-accent">
CC BY 4.0
</a> </span> </div> </div> </footer>  </body></html> <script data-astro-rerun>
  /** Create a progress indicator
   *  at the top */
  function createProgressBar() {
    // Create the main container div
    const progressContainer = document.createElement("div");
    progressContainer.className =
      "progress-container fixed top-0 z-10 h-1 w-full bg-background";

    // Create the progress bar div
    const progressBar = document.createElement("div");
    progressBar.className = "progress-bar h-1 w-0 bg-accent";
    progressBar.id = "myBar";

    // Append the progress bar to the progress container
    progressContainer.appendChild(progressBar);

    // Append the progress container to the document body or any other desired parent element
    document.body.appendChild(progressContainer);
  }
  createProgressBar();

  /** Update the progress bar
   *  when user scrolls */
  function updateScrollProgress() {
    document.addEventListener("scroll", () => {
      const winScroll =
        document.body.scrollTop || document.documentElement.scrollTop;
      const height =
        document.documentElement.scrollHeight -
        document.documentElement.clientHeight;
      const scrolled = (winScroll / height) * 100;
      if (document) {
        const myBar = document.getElementById("myBar");
        if (myBar) {
          myBar.style.width = scrolled + "%";
        }
      }
    });
  }
  updateScrollProgress();

  /** Attaches links to headings in the document,
   *  allowing sharing of sections easily */
  function addHeadingLinks() {
    const headings = Array.from(
      document.querySelectorAll("h2, h3, h4, h5, h6")
    );
    for (const heading of headings) {
      heading.classList.add("group");
      const link = document.createElement("a");
      link.className =
        "heading-link ms-2 no-underline opacity-75 md:opacity-0 md:group-hover:opacity-100 md:focus:opacity-100";
      link.href = "#" + heading.id;

      const span = document.createElement("span");
      span.ariaHidden = "true";
      span.innerText = "#";
      link.appendChild(span);
      heading.appendChild(link);
    }
  }
  addHeadingLinks();

  /** Attaches copy buttons to code blocks in the document,
   * allowing users to copy code easily. */
  function attachCopyButtons() {
    const copyButtonLabel = "Copy";
    const codeBlocks = Array.from(document.querySelectorAll("pre"));

    for (const codeBlock of codeBlocks) {
      const wrapper = document.createElement("div");
      wrapper.style.position = "relative";

      // Check if --file-name-offset custom property exists
      const computedStyle = getComputedStyle(codeBlock);
      const hasFileNameOffset =
        computedStyle.getPropertyValue("--file-name-offset").trim() !== "";

      // Determine the top positioning class
      const topClass = hasFileNameOffset
        ? "top-(--file-name-offset)"
        : "-top-3";

      const copyButton = document.createElement("button");
      copyButton.className = `copy-code absolute end-3 ${topClass} rounded bg-muted border border-muted px-2 py-1 text-xs leading-4 text-foreground font-medium`;
      copyButton.innerHTML = copyButtonLabel;
      codeBlock.setAttribute("tabindex", "0");
      codeBlock.appendChild(copyButton);

      // wrap codebock with relative parent element
      codeBlock?.parentNode?.insertBefore(wrapper, codeBlock);
      wrapper.appendChild(codeBlock);

      copyButton.addEventListener("click", async () => {
        await copyCode(codeBlock, copyButton);
      });
    }

    async function copyCode(block, button) {
      const code = block.querySelector("code");
      const text = code?.innerText;

      await navigator.clipboard.writeText(text ?? "");

      // visual feedback that task is completed
      button.innerText = "Copied";

      setTimeout(() => {
        button.innerText = copyButtonLabel;
      }, 700);
    }
  }
  attachCopyButtons();

  /* Go to page start after page swap */
  document.addEventListener("astro:after-swap", () =>
    window.scrollTo({ left: 0, top: 0, behavior: "instant" })
  );
</script>